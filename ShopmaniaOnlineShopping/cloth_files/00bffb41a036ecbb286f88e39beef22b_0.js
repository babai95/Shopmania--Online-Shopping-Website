function oSendpulsePush(){var c="http://www.templatemonster.com";var d="http://www.templatemonster.com";var a="https://templatemonstercom.sendpulse.com";var h=true;var b=true;var t="00bffb41a036ecbb286f88e39beef22b";var e="https://sendpulse.com:4434";var f="web.com.sendpulse.push";var m={};var s="";var q=null;var i=null;var n=null;var j={};var o=false;var k={ru:"запрашивает разрешение на:",en:"wants to:",ua:"запитує дозвіл на:"};var g={ru:"Показывать оповещения",en:"Show notifications",ua:"Показувати сповіщення"};var p={ru:"Разрешить",en:"Allow",ua:"Дозволити"};var r={ru:"Блокировать",en:"Block",ua:"Блокувати"};var l=false;this.start=function(){if(!oSpP.detectSite()){oSpP.log("Application allowed only for "+c);return false}if(oSpP.detectOs()=="iOS"){oSpP.log("Application can not work on iOS");return false}var u=oSpP.detectOs();if(!b){if((u=="iOS")||(u=="Android")){oSpP.log("Application disabled for your device");return false}}m=oSpP.detectBrowser();s=m.name.toLowerCase();if((s=="chrome")&&(parseFloat(m.version)<42)){oSpP.log("Application can not work with Crome browser version less then 42");return false}if((s=="firefox")&&(parseFloat(m.version)<44)){oSpP.log("Application can not work with Firefox browser version less then 44");return false}if((s=="firefox")&&(u=="Android")){oSpP.log("Application can not work with Firefox on Android");return false}if((s=="chrome")||(s=="firefox")){window.addEventListener("message",function(x){if(x.origin==a){if(x.data=="initend"){clearInterval(i)}else{if(x.data=="closeme"){n.close()}else{oSpP.storeSubscription(x.data)}}}},false);if(h){oSpP.getDbValue("SPIDs","SubscriptionId",function(x){if(x.target.result===undefined){oSpP.getDbValue("SPIDs","PromptClosed",function(z){if(z.target.result===undefined){oSpP.showPrompt()}else{var y=parseInt(z.target.result.value);y--;if(y==0){oSpP.deleteDbValue("SPIDs","PromptClosed");oSpP.showPrompt()}else{oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:y})}}})}})}else{var w=document.querySelectorAll(".sp_notify_prompt");for(var v=0;v<w.length;v++){w[v].addEventListener("click",function(){oSpP.showPopUp()})}}}else{if(s=="safari"){if(h){oSpP.startSubscription()}else{var w=document.querySelectorAll(".sp_notify_prompt");for(var v=0;v<w.length;v++){w[v].addEventListener("click",function(){oSpP.startSubscription()})}}}}};this.startSubscription=function(){switch(s){case"safari":if(oSpP.isSafariNotificationSupported()){var u=window.safari.pushNotification.permission(f);oSpP.checkSafariPermission(u)}break}};this.checkCookie=function(v){for(var x=v+"=",w=document.cookie.split(";"),y=0;y<w.length;y++){for(var u=w[y];" "==u.charAt(0);){u=u.substring(1)}if(0==u.indexOf(x)){return u.substring(x.length,u.length)}}return""};this.checkSafariPermission=function(u){oSpP.log("[DD] Permissions: "+u.permission);if(u.permission==="default"){l=true;oSpP.getDbValue("SPIDs","PromptShowed",function(v){if(v.target.result===undefined){oSpP.sendPromptStat("prompt_showed");oSpP.putValueToDb("SPIDs",{type:"PromptShowed",value:1})}else{oSpP.sendPromptStat("prompt_showed_again")}});window.safari.pushNotification.requestPermission(e,f,{appkey:t},oSpP.checkSafariPermission)}else{if(u.permission==="denied"){if(l){oSpP.sendPromptStat("prompt_denied")}}else{if(u.permission==="granted"){if(l){oSpP.sendPromptStat("prompt_granted")}oSpP.subscribe()}}}};this.subscribe=function(){switch(s){case"safari":var v=window.safari.pushNotification.permission(f);if(v.permission==="granted"){var u=v.deviceToken;oSpP.checkLocalSubsctoption(u)}break}};this.checkLocalSubsctoption=function(u){oSpP.log("[DD] subscribe :: subscriptionId: "+u);oSpP.getDbValue("SPIDs","SubscriptionId",function(v){if(v.target.result===undefined){oSpP.sendSubscribeDataToServer(u,"subscribe");oSpP.putValueToDb("SPIDs",{type:"SubscriptionId",value:u})}else{if(v.target.result.value!==u){oSpP.sendSubscribeDataToServer(v.target.result.value,"unsubscribe");oSpP.sendSubscribeDataToServer(u,"subscribe");oSpP.putValueToDb("SPIDs",{type:"SubscriptionId",value:u})}}})};this.sendSubscribeDataToServer=function(u,y,v){var w=new XMLHttpRequest();w.open("POST",e,true);w.setRequestHeader("Content-Type","application/json");if(v===undefined){v={};v.uname=oSpP.checkCookie("lgn");v.os=oSpP.detectOs()}var x=new XMLHttpRequest();x.onreadystatechange=function(){if(x.readyState==4){if(x.status==200){v.ip=x.responseText.replace("\n","")}else{v.ip=""}v.variables=oSpP.getUserVariables();var z=window.location.href;var A={action:"subscription",subscriptionId:u,subscription_action:y,appkey:t,browser:m,lang:oSpP.getBrowserlanguage(),url:z,custom_data:v};w.send(JSON.stringify(A))}};x.open("GET",e+"/getip",true);x.send()};this.isSafariNotificationSupported=function(){return"safari" in window&&"pushNotification" in window.safari};this.storeSubscription=function(u){oSpP.log("StoreSubscription: "+u);oSpP.putValueToDb("SPIDs",{type:"SubscriptionId",value:u})};this.clearDomain=function(u){return u.replace("://www.","://").replace("://www2.","://")};this.detectSite=function(){return(!(oSpP.clearDomain(window.location.href).indexOf(oSpP.clearDomain(c))===-1))};this.getBrowserlanguage=function(){return navigator.language.substring(0,2)};this.getUserVariables=function(){var v={};var u=document.querySelectorAll("input.sp_push_custom_data");for(var w=0;w<u.length;w++){switch(u[w].type){case"text":case"hidden":v[u[w].name]=u[w].value;break;case"checkbox":v[u[w].name]=(u[w].checked)?1:0;break;case"radio":if(u[w].checked){v[u[w].name]=u[w].value}break}}return v};this.showPopUp=function(){if(h){oSpP.sendPromptStat("prompt_granted")}else{}var C=580;var y=580;var A=window.screenLeft!==undefined?window.screenLeft:screen.left;var u=window.screenTop!==undefined?window.screenTop:screen.top;var v=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width;var D=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;var x=((v/2)-(C/2))+A;var B=((D/3)-(D/3))+u;var z=oSpP.getBrowserlanguage();if(z==""){z="en"}n=window.open(a+"/"+z+"/"+t,"_blank","scrollbars=yes, width="+C+", height="+y+", top="+B+", left="+x);if(window.focus){n.focus()}i=setInterval(function(){n.postMessage("init",a);n.postMessage("initpage|"+window.location.href,a);n.postMessage("initvariables|"+JSON.stringify(oSpP.getUserVariables()),a)},100);if(h){oSpP.closePrompt(true)}};this.showPrompt=function(){oSpP.getDbValue("SPIDs","PromptShowed",function(F){if(F.target.result===undefined){oSpP.sendPromptStat("prompt_showed");oSpP.putValueToDb("SPIDs",{type:"PromptShowed",value:1})}else{oSpP.sendPromptStat("prompt_showed_again")}});var C=document.getElementsByTagName("head")[0];var u=document.createElement("link");u.rel="stylesheet";u.type="text/css";u.href="https://cdn.sendpulse.com/css/push/sendpulse-prompt-def4.css";u.media="all";C.appendChild(u);var x=oSpP.getMessageLang(oSpP.getBrowserlanguage());var A=document.createElement("div");A.setAttribute("class","sendpulse-prompt sendpulse-popover");var w=document.createElement("div");w.setAttribute("class","sendpulse-prompt-message");var E=document.createElement("div");E.setAttribute("class","sendpulse-prompt-message-text");E.innerHTML=d+" "+k[x];var y=document.createElement("div");y.setAttribute("class","sendpulse-prompt-info sendpulse-prompt-message-text");var B=document.createElement("img");B.setAttribute("class","sendpulse-bell-icon");B.setAttribute("width","14");B.setAttribute("height","14");B.setAttribute("src","https://cdn.sendpulse.com/img/push/icon-ring.svg");y.appendChild(B);y.innerHTML+=" "+g[x];var D=document.createElement("div");D.setAttribute("class","sendpulse-prompt-buttons");var z=document.createElement("button");z.setAttribute("class","sendpulse-prompt-btn sendpulse-accept-btn");z.setAttribute("type","button");z.setAttribute("onclick","oSpP.showPopUp(); return false;");z.innerHTML=p[x];var v=document.createElement("button");v.setAttribute("class","sendpulse-prompt-btn sendpulse-disallow-btn");v.setAttribute("type","button");v.setAttribute("onclick","oSpP.denyMessage(); return false;");v.innerHTML=r[x];D.appendChild(z);D.appendChild(v);w.appendChild(E);w.appendChild(y);w.appendChild(D);A.appendChild(w);document.body.appendChild(A)};this.denyMessage=function(){oSpP.sendPromptStat("prompt_denied");oSpP.storeSubscription("DENY");oSpP.closePrompt(true)};this.closePrompt=function(u){if(u===undefined){oSpP.sendPromptStat("prompt_closed")}document.body.removeChild(document.querySelector(".sendpulse-prompt"));oSpP.putValueToDb("SPIDs",{type:"PromptClosed",value:1})};this.initDb=function(w){if(q){return void w()}var v=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;var u=v.open("sendpulse_push_db",2);u.onsuccess=function(x){q=x.target.result;w()};u.onupgradeneeded=function(x){var y=x.target.result;y.createObjectStore("SPIDs",{keyPath:"type"})}};this.getDbValue=function(u,v,w){oSpP.initDb(function(){q.transaction([u],"readonly").objectStore(u).get(v).onsuccess=w})};this.putValueToDb=function(u,v){oSpP.initDb(function(){q.transaction([u],"readwrite").objectStore(u).put(v)})};this.deleteDbValue=function(u,v){oSpP.initDb(function(){q.transaction([u],"readwrite").objectStore(u)["delete"](v)})};this.log=function(u){};this.detectBrowser=function(){var w,v=navigator.userAgent,u=v.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];var x=v.match(/(edge(?=\/))\/?\s*(\d+)/i)||[];if("Edge"===x[1]){return{name:x[1],version:x[2]}}return/trident/i.test(u[1])?(w=/\brv[ :]+(\d+)/g.exec(v)||[],{name:"IE",version:w[1]||""}):"Chrome"===u[1]&&(w=v.match(/\bOPR\/(\d+)/),null!=w)?{name:"Opera",version:w[1]}:(u=u[2]?[u[1],u[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(w=v.match(/version\/(\d+)/i))&&u.splice(1,1,w[1]),{name:u[0],version:u[1]})};this.detectOs=function(){var u="";if(navigator.userAgent.indexOf("Windows")!=-1){return("Windows")}if(navigator.userAgent.indexOf("Android")!=-1){return("Android")}if(navigator.userAgent.indexOf("Linux")!=-1){return("Linux")}if(navigator.userAgent.indexOf("iPhone")!=-1){return("iOS")}if(navigator.userAgent.indexOf("Mac")!=-1){return("Mac OS")}if(navigator.userAgent.indexOf("FreeBSD")!=-1){return("FreeBSD")}return""};this.uns=function(){oSpP.deleteDbValue("SPIDs","SubscriptionId")};this.getMessageLang=function(u){u=u.substring(0,2).toLowerCase();if(u=="ua"||u=="uk"){return"ua"}else{if(u=="ru"){return"ru"}else{return"en"}}};this.push=function(u,v){if(!oSpP.detectSite()){oSpP.log("Application allowed only for "+c);return false}j[u]=v;oSpP.getDbValue("SPIDs","SubscriptionId",function(w){if(w.target.result===undefined){if(!o){o=setInterval(function(){oSpP.getDbValue("SPIDs","SubscriptionId",function(x){if(x.target.result!==undefined){oSpP.sendUpdatesToServer(x.target.result.value);clearInterval(o);o=false}})},1000)}}else{oSpP.sendUpdatesToServer(w.target.result.value)}})};this.sendUpdatesToServer=function(u){var w=new XMLHttpRequest();w.open("POST",e,true);w.setRequestHeader("Content-Type","application/json");var v={action:"subscription",subscriptionId:u,subscription_action:"update_variables",appkey:t,custom_data:{variables:j}};w.send(JSON.stringify(v))};this.sendPromptStat=function(w){oSpP.log("[DD] Send prompt stat: "+w);var v=new XMLHttpRequest();v.open("POST",e,true);v.setRequestHeader("Content-Type","application/json");var u={action:"statisctic",statisctic_action:w,appkey:t};v.send(JSON.stringify(u))}}window.addEventListener("load",function(){oSpP.start()});var oSpP=new oSendpulsePush();